(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{N7ne:function(a,e,s){"use strict";s.r(e),s.d(e,"_frontmatter",(function(){return p})),s.d(e,"default",(function(){return b}));s("91GP"),s("rGqo"),s("yt8O"),s("Btvt"),s("RW0V"),s("FlsD"),s("q1tI");var n=s("7ljp"),t=s("hhGP");s("qKvR");function c(){return(c=Object.assign||function(a){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(a[n]=s[n])}return a}).apply(this,arguments)}var p={};void 0!==p&&p&&p===Object(p)&&Object.isExtensible(p)&&!p.hasOwnProperty("__filemeta")&&Object.defineProperty(p,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/pages/Deployment/Github_actions.md"}});var m={_frontmatter:p},r=t.a;function b(a){var e=a.components,s=function(a,e){if(null==a)return{};var s,n,t={},c=Object.keys(a);for(n=0;n<c.length;n++)s=c[n],e.indexOf(s)>=0||(t[s]=a[s]);return t}(a,["components"]);return Object(n.b)(r,c({},m,s,{components:e,mdxType:"MDXLayout"}),Object(n.b)("h1",{id:"deploy-documentation-automatic-with-github-actions"},"Deploy documentation automatic with Github Actions"),Object(n.b)("h2",{id:"add-workflow-to-source-code"},"Add workflow to source code"),Object(n.b)("p",null,"Create a new file in your source repository, named ",Object(n.b)("inlineCode",{parentName:"p"},".github/workflows/deploy_docs.yml")),Object(n.b)("p",null,"It could contain an action with this steps:"),Object(n.b)("pre",{className:"grvsc-container default-dark","data-language":"yaml","data-index":"0"},Object(n.b)("code",c({parentName:"pre"},{className:"grvsc-code"}),Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Deploy documentation")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"on"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"  "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"push"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"    "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"branches"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"master")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"jobs"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"  "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"build"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"    "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"runs-on"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"ubuntu-latest")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"    "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"steps"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Checkout")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"uses"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"actions/checkout@v1")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Set Node.js")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"uses"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"actions/setup-node@v1")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"with"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),":")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"          "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"node-version"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"10.x")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Install npm dependencies")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"working-directory"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"./docs")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"run"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"npm install")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Run tests")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"working-directory"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"./docs")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"continue-on-error"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"false")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"run"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"npm run test")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"})),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"      - "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"name"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"Deploy pages")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"working-directory"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"./docs")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"        "),Object(n.b)("span",c({parentName:"span"},{className:"mtk4"}),"run"),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),": "),Object(n.b)("span",c({parentName:"span"},{className:"mtk15"}),"|")),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"          "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),'git config --global user.name "Spark documentation bot"')),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"          "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),'git config --global user.email "spark@docbot.com"')),"\n",Object(n.b)("span",c({parentName:"code"},{className:"grvsc-line"}),Object(n.b)("span",c({parentName:"span"},{className:"mtk1"}),"          "),Object(n.b)("span",c({parentName:"span"},{className:"mtk8"}),"npx gatsby build --prefix-paths && npx gh-pages -d public -r https://${{ secrets.GH_TOKEN }}@github.com/losol/doksi.git")))),Object(n.b)("p",null,"Please remember to change the link to your own git repository."),Object(n.b)("h2",{id:"get-personal-access-token"},"Get personal access token"),Object(n.b)("p",null,"In GitHub Settings -> Developer -> Personal access token, create a new Personal access token with repo scope:\n",Object(n.b)("img",{alt:"image",src:"https://user-images.githubusercontent.com/17168367/69485965-ad869780-0e46-11ea-91a3-dbbdf6c70be3.png"})),Object(n.b)("h2",{id:"add-repo-secret"},"Add repo secret"),Object(n.b)("p",null,"Then add a new secret to the repo settings, with name ",Object(n.b)("inlineCode",{parentName:"p"},"GH_TOKEN")),Object(n.b)("p",null,Object(n.b)("img",{alt:"image",src:"https://user-images.githubusercontent.com/17168367/69485949-4b2d9700-0e46-11ea-92f7-8b3098913918.png"})),Object(n.b)("style",{className:"grvsc-styles"},"\n  .grvsc-container {\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n  }\n  \n  .grvsc-code {\n    display: inline-block;\n    min-width: 100%;\n  }\n  \n  .grvsc-line {\n    display: inline-block;\n    box-sizing: border-box;\n    width: 100%;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-line-highlighted {\n    background-color: var(--grvsc-line-highlighted-background-color, transparent);\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, transparent);\n  }\n  \n  .default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .default-dark .mtk4 { color: #569CD6; }\n  .default-dark .mtk1 { color: #D4D4D4; }\n  .default-dark .mtk8 { color: #CE9178; }\n  .default-dark .mtk15 { color: #C586C0; }\n"))}void 0!==b&&b&&b===Object(b)&&Object.isExtensible(b)&&!b.hasOwnProperty("__filemeta")&&Object.defineProperty(b,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/pages/Deployment/Github_actions.md"}}),b.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-deployment-github-actions-md-b9b333439a7762862430.js.map